<div class="w-full flex justify-center px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8 pb-24 sm:pb-4 overflow-hidden">
  <p-card class="w-full max-w-2xl sm:max-w-3xl lg:max-w-4xl">
    <ng-template pTemplate="header">
      <div class="flex justify-center py-4">
        <div class="text-center">
          <h1 class="text-3xl sm:text-4xl font-bold mb-2 text-white tracking-wide">
            Registrar
            <span class="bg-linear-to-r from-amber-400 via-amber-500 to-orange-600 text-transparent bg-clip-text font-extrabold">
              Acción
            </span>
          </h1>
        </div>
      </div>
    </ng-template>

    <!-- Formulario -->
    <form class="space-y-4 sm:space-y-6" [formGroup]="form" (ngSubmit)="onSubmit()">
      
      <!-- Selector de Usuario y Período -->
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <!-- Usuario -->
        <div class="space-y-2">
          <label for="usuario" class="block text-base font-semibold text-gray-100">
            Usuario
          </label>
          
          @if (user.isLoading()) {
            <p-progressSpinner 
              [style]="{ width: '50px', height: '50px' }"
              strokeWidth="4"
              fill="var(--surface-ground)"
              animationDuration=".5s">
            </p-progressSpinner>
          } @else {
            <p-select
              id="usuario"
              formControlName="usuarioId"
              [options]="usuariosList()"
              optionLabel="nombre1"
              optionValue="id"
              placeholder="Selecciona un usuario"
              [showClear]="true"
              class="w-full h-11!">
            </p-select>
          }
          
          @if (isFieldInvalid('usuarioId')) {
            <small class="text-red-400 block text-sm">
              El usuario es requerido
            </small>
          }
        </div>

        <!-- Período -->
        <div class="space-y-2">
          <label for="periodo" class="block text-base font-semibold text-gray-100">
            Período
          </label>
          <p-select
            id="periodo"
            formControlName="periodo"
            [options]="periodosList()"
            optionLabel="label"
            optionValue="value"
            placeholder="Selecciona un período"
            class="w-full h-11!">
          </p-select>
          @if (isFieldInvalid('periodo')) {
            <small class="text-red-400 block text-sm">
              El período es requerido
            </small>
          }
        </div>
      </div>

      <!-- Número y Valor -->
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <!-- Número -->
        <div class="space-y-2">
          <label for="numero" class="block text-base font-semibold text-gray-100">
            Número
          </label>
          <p-iconfield class="w-full">
            <p-inputicon class="pi pi-hashtag text-gray-400"></p-inputicon>
            <p-inputnumber
              id="numero"
              formControlName="numero"
              placeholder="Ingresa el número"
              [useGrouping]="false"
              class="w-full h-11!">
            </p-inputnumber>
          </p-iconfield>
          @if (isFieldInvalid('numero')) {
            <small class="text-red-400 block text-sm">
              Debe ser mayor a 0
            </small>
          }
        </div>

        <!-- Valor -->
        <div class="space-y-2">
          <label for="valor" class="block text-base font-semibold text-gray-100">
            Valor
          </label>
          <p-iconfield class="w-full">
            <p-inputicon class="pi pi-dollar text-gray-400"></p-inputicon>
            <p-inputnumber
              id="valor"
              formControlName="valor"
              placeholder="Auto"
              mode="currency"
              currency="USD"
              [useGrouping]="true"
              [readonly]="true"
              class="w-full h-11!">
            </p-inputnumber>
          </p-iconfield>
          @if (isFieldInvalid('valor')) {
            <small class="text-red-400 block text-sm">
              El valor es requerido
            </small>
          }
        </div>
      </div>

      <!-- Fila 3: Fecha, Guardar, Limpiar -->
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 auto-rows-max">
        <!-- Fecha -->
        <div class="space-y-2 flex flex-col">
          <label for="fecha" class="block text-base font-semibold text-gray-100">
            Fecha
          </label>
          <div class="flex-1">
            <p-datepicker
              id="fecha"
              formControlName="fecha"
              dateFormat="dd/mm/yy"
              placeholder="Selecciona una fecha"
              [showIcon]="true"
              styleClass="w-full"
              inputStyleClass="w-full h-11">
            </p-datepicker>
          </div>
          @if (isFieldInvalid('fecha')) {
            <small class="text-red-400 block text-sm">
              La fecha es requerida
            </small>
          }
        </div>

        <!-- Guardar -->
        <div class="flex flex-col justify-between sm:justify-end h-full">
          <label class="text-base font-semibold text-gray-100 invisible sm:visible">
            Acción
          </label>
          <p-button
            type="submit"
            label="Guardar"
            icon="pi pi-save"
            [disabled]="form.invalid || isLoading()"
            [loading]="isLoading()"
            styleClass="w-full"
            [style]="{'height': '44px'}">
          </p-button>
        </div>

        <!-- Limpiar -->
        <div class="flex flex-col justify-between sm:justify-end h-full">
          <label class="text-base font-semibold text-gray-100 invisible sm:visible">
            Acción
          </label>
          <p-button
            type="button"
            label="Limpiar"
            icon="pi pi-times"
            severity="secondary"
            (onClick)="onReset()"
            [disabled]="isLoading()"
            styleClass="w-full"
            [style]="{'height': '44px'}">
          </p-button>
        </div>
      </div>
    </form>
  </p-card>
</div>
