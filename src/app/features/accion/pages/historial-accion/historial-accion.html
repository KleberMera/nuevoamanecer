<div class="space-y-4 sm:space-y-6 ">
  <!-- Encabezado con título diseño registrar-accion -->
  <div>
    <h2 class="text-xl sm:text-2xl lg:text-3xl font-bold text-gray-100">
      Historial de <span class="text-primary">Acciones</span>
    </h2>
  </div>

  <!-- Filtros: Período y Búsqueda Usuario -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4">
    <!-- Selector de Período -->
    <div class="space-y-2">
      <label for="periodo" class="block text-sm sm:text-base font-semibold text-gray-100">
        Período
      </label>
      <p-select 
        id="periodo" 
        [formControl]="periodoControl"
        [options]="periodosList()" 
        optionLabel="label" 
        optionValue="value"
        placeholder="Selecciona"
        class="w-full h-10 sm:h-11!">
      </p-select>
    </div>

    <!-- Búsqueda de Usuario -->
    <div class="space-y-2">
      <label for="usuarioBusca" class="block text-sm sm:text-base font-semibold text-gray-100">
        Buscar Usuario
      </label>
      <p-iconfield class="w-full">
        <p-inputicon class="pi pi-search text-gray-400"></p-inputicon>
        <input 
          pInputText
          type="text" 
          id="usuarioBusca"
          [formControl]="usuarioBuscaControl"
          placeholder="Nombre o apellido..."
          class="w-full h-10 sm:h-11!">
      </p-iconfield>
    </div>
  </div>

  <!-- Tabla de acciones con PrimeNG -->
  @if (hasError()) {
    <div class="flex items-center gap-3 p-3 sm:p-4 bg-red-500/10 border border-red-500/30 rounded-lg">
      <i class="pi pi-exclamation-triangle text-red-400 text-lg sm:text-xl"></i>
      <div>
        <p class="text-red-400 font-semibold text-sm sm:text-base">Error al cargar</p>
        <p class="text-red-300 text-xs sm:text-sm">{{ errorMessage() }}</p>
      </div>
    </div>
  } @else {
    <div class="overflow-x-auto rounded-lg">
      <p-table
        [value]="acciones()"
        [loading]="isLoading()"
        [rows]="5"
        [paginator]="true"
        [globalFilterFields]="['usuario.nombre1', 'usuario.apellido1', 'numero', 'valor', 'estado']"
        class="p-datatable-striped text-xs sm:text-sm"
        [scrollable]="true"
        [rowsPerPageOptions]="[5, 10, 20]"
        scrollHeight="flex"
        rowHover
        showGridlines
      >
        <ng-template pTemplate="header">
         <tr>
            <th pSortableColumn="usuario.nombre1" style="width:25%">Usuario <p-sortIcon field="usuario.nombre1"></p-sortIcon></th>
              <th pSortableColumn="periodo" style="width:15%">Periodo <p-sortIcon field="periodo"></p-sortIcon></th>
            
            <th pSortableColumn="numero" style="width:15%">Cantidad <p-sortIcon field="numero"></p-sortIcon></th>
            <th pSortableColumn="valor" style="width:18%">Valor <p-sortIcon field="valor"></p-sortIcon></th>
            <th pSortableColumn="fecha" style="width:18%">Fecha <p-sortIcon field="fecha"></p-sortIcon></th>
            <th pSortableColumn="estado" style="width:15%">Estado <p-sortIcon field="estado"></p-sortIcon></th>
            <th style="width:9%">Acciones</th>
          </tr>
        </ng-template>
        
        <ng-template pTemplate="body" let-accion>
          <tr>
            <td>
              <span class="text-gray-200 font-medium text-xs sm:text-sm">{{ getNombreCompleto(accion) }}</span>
            </td>
                <td>
              <span class="text-gray-200 font-medium text-xs sm:text-sm">{{ accion.periodo }}</span>
            </td>
            <td>
              <span class="text-gray-200 text-xs sm:text-sm">{{ accion.numero }}</span>
            </td>
            <td>
              <span class="text-gray-200 font-semibold text-xs sm:text-sm">{{ accion.valor | currency }}</span>
            </td>
            <td>
              <span class="text-gray-200 text-xs sm:text-sm">{{ accion.fecha | date: 'dd/MM/yyyy' }}</span>
            </td>
            <td>
              <p-tag 
                [value]="getEstadoTexto(accion.estado)"
                [severity]="accion.estado === 'A' ? 'success' : 'secondary'">
              </p-tag>
            </td>
            <td>
              <p-button 
                icon="pi pi-eye" 
                [rounded]="true" 
                [text]="true" 
                [plain]="true"
                severity="info"
                pTooltip="Ver detalles"
                tooltipPosition="top">
              </p-button>
            </td>
          </tr>
        </ng-template>
        
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="7" class="text-center py-6 sm:py-8">
              <div class="flex flex-col items-center gap-2">
                <i class="pi pi-inbox text-xl sm:text-2xl text-gray-400"></i>
                <p class="text-gray-400 text-sm sm:text-base">No hay acciones registradas</p>
              </div>
            </td>
          </tr>
        </ng-template>
        
        <ng-template pTemplate="loadingbody">
          <tr>
            <td colspan="7" class="text-center py-6 sm:py-8">
              <p class="text-gray-400 text-sm sm:text-base">Cargando acciones...</p>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  }
</div>

